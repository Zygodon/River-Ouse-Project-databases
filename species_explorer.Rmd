---
title: "Species Explorer"
author: "John"
date: "02/12/2019"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(dplyr)
# source("db_extract.R")
# the_data <- GetTheData()
```

The only purpose of Species Explorer is to get information from the database about species frequency in the assessed Mesotrophic Grassland communities. It is interactive: selecting a species from the drop-down list gives a display of frequency compared with the NVC standard, and a downloadable table of the results.

```{r, echo=FALSE}
selectInput("Species", "Choose a species", 
            choices <-  (the_data %>% select(species_name) 
                       %>% distinct() 
                       %>% arrange(species_name))
)
textOutput("Selected")

downloadHandler(filename = function() { 
    return(paste('Example', input$Species, '.csv', sep=''))

 }, content = function(file) {
   write.csv(the_table(), file)
 })

tableOutput("table")

output$Selected <- renderText({
  paste("You chose", input$Species)
})

the_table <- reactive({
  SpeciesFreqWithStandard(the_data, input$Species)
})

# Table of selected species ----
output$table <- renderTable({the_table()})

```

 